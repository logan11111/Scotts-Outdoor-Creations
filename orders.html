<!DOCTYPE html>
<html>
    <head>
        <title> Scott's Outdoor Creations</title>
        <link href='https://fonts.googleapis.com/css?family=Grape Nuts' rel='stylesheet'>
        <link rel="stylesheet" href="orders.css">
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    <body>
            <div id="confirmationPopup" class="popup">
                <div class="popup-content">
                    <span class="close">&times;</span>
                    <h1 style="color: #E4C59E; font-family: 'Times New Roman';">Confirm Your Order</h1>
                    <h2 style="color: #E4C59E; font-family: 'Times New Roman';"> Order Details</h2>
                    <div id="popupOrderDetails" style="color: #AF8260; font-family: 'Times New Roman';"></div>
                    <h2 style="color: #E4C59E; font-family: 'Times New Roman';"> Contact Information</h2>
                    <p style="color: #E4C59E; font-family: 'Times New Roman';">
                        <strong>First Name:</strong> <span id="popupFirstName" style="color: #AF8260;"></span><br>
                        <strong>Last Name:</strong> <span id="popupLastName" style="color: #AF8260;"></span><br>
                        <strong>Phone Number:</strong> <span id="popupPhoneNumber" style="color: #AF8260;"></span><br>
                        <strong>Email:</strong> <span id="popupEmail" style="color: #AF8260;"></span><br>
                        <strong>Special Requests:</strong> <span id="popupSpecialRequests" style="color: #AF8260;"></span>
                    </p>
                    <h2 style="color: #E4C59E; font-family: 'Times New Roman';"> Order Total</h2>
                    <span id="priceTotalAll" style="color: #AF8260;"></span><br>
                    <p style="color: #E4C59E; font-family: 'Times New Roman';">Are you sure you want to place this order?</p>
                    <div class="popup-buttons">
                        <button id="confirmButton">Confirm</button>
                        <button id="cancelButton">Cancel</button>
                    </div>
                </div>
            </div>
        <div class="header">
            <h1 class="TitleOrder">ORDER</h1>
        </div>
        <div class="explanation">
            <p class="introParagraph"> Thank you for making the decision to order handcrafted outdoor furniture from Scotts Outdoor Creations! 
                Please fill in the form and information below and add as much (or little) detail as you would like to give me the best opportunity to create exactly what you are looking for to meet your outdoor furniture needs. 
                <br><br>All I ask is that you put down 50% of the total cost as a guarantee of commitment. This will be non-refundable if you change your mind or cancel the order, as the material is bought as orders are received. 
                My guarantee to you is that I commit to creating the best product that I can and will warranty deficiencies in my work for one year from the date of pick up. Timeframe from order to pick-up will depend on demand at the time and I will be transparent with you about timing from the start.  Payment options are: Etransfers,Cash or money orders only. No cheques will be accepted for payment.                
            </p>
        </div>
        <hr style="border-color: #E4C59E;">
        <div class="orderArea">
            <a class="selectionText">Select Item(s):</a>
            <div class="selection">
                <div class="itemChoice">
                    <img class="pic" src="pictures/AchairFront.jpg">
                    <div class="description"> 
                        <a class="itemChoiceHeader">FULL SIZE ADIRONDACK CHAIR</a>
                        <a class="price">$350</a>
                        <label for="quantities">Choose Quantity:</label>
                        <select name="quantities" id="quantities">     <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                        </select>
                    </div>
                </div>
                <div class="itemChoice">
                    <img class="pic" src="pictures/smallchairfront.jpg">
                    <div class="description">
                        <a class="itemChoiceHeader">SMALL ADIRONDACK CHAIR</a>
                        <a class="price">$300</a>
                        <label for="quantities">Choose Quantity:</label>
                        <select name="quantities" id="quantities">     <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                        </select>
                    </div>
                </div>
                <div class="itemChoice">
                    <img class="pic" src="pictures/AchairSetFront.jpg">
                    <div class="description"> 
                        <a class="itemChoiceHeader">ADIRONDACK CHAIR SET</a>
                        <br>
                        <a class="price">$450</a>
                        <label for="quantities">Choose Quantity:</label>
                        <select name="quantities" id="quantities">     <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                        </select>
                    </div>
                </div>
                <div class="itemChoice">
                    <img class="pic" src="pictures/planterFront.jpg">
                    <div class="description">
                        <a class="itemChoiceHeader">THREE TIER PLANTER</a>
                        <a class="price">$300</a>
                        <label for="quantities">Choose Quantity:</label>
                        <select name="quantities" id="quantities">     <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                        </select>
                    </div>
                </div>
                <div class="itemChoice">
                    <img class="pic" src="pictures/RockerSide.jpg">
                    <div class="description">
                        <a class="itemChoiceHeader">ADIRONDACK ROCKER</a>
                        <a class="price">$400</a>
                        <label for="quantities">Choose Quantity:</label>
                        <select name="quantities" id="quantities">     <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <form id="orderForm" action="https://formspree.io/f/xvgpaevl" method="post">
            <div class="endingInfo">
                <div class="selection">
                    <label class="selectionTextBottom">First Name:</label>
                    <input type="text" name="firstName" class="inputText" placeholder="First Name" required>
                </div>
                <div class="selection">
                    <label class="selectionTextBottom">Last Name:</label>
                    <input type="text" name="lastName" class="inputText" placeholder="Last Name" required>
                </div>
                <div class="selection">
                    <label class="selectionTextBottom">Phone Number:</label>
                    <input type="tel" name="phoneNumber" class="inputText" placeholder="Phone Number" required>
                </div>
                <div class="selection">
                    <label class="selectionTextBottom">Email:</label>
                    <input type="email" name="email" class="inputText" placeholder="Email" required>
                </div>
                <div class="selection">
                    <label class="selectionTextBottom">Special Requests:</label>
                    <input type="text" name="specialRequests" class="specialText" placeholder="Please be specific with any special requests, field not required">
                </div>
            </div> 
            <!-- Hidden fields for order details and grand total -->
            <input type="hidden" id="hiddenOrderDetails" name="orderDetails">
            <input type="hidden" id="hiddenGrandTotal" name="grandTotal">
            <button type="submit" class="placeButton">Place Order! &#8658;</button>
        </form>
        <input type="hidden" name="orderDetails" id="hiddenOrderDetails">
        <input type="hidden" name="grandTotal" id="hiddenGrandTotal">
        <button class="homeButton" onclick="location.href='index.html'">&#8656; HOME</button>
        <script>
            let orderDetails = ''; // Initialize at the beginning of the script
            let grandTotal = 0; // Initialize at the beginning of the script
            // Wait for the DOM to be fully loaded
            document.addEventListener('DOMContentLoaded', function () {
                const form = document.querySelector('#orderForm');
                const placeOrderButton = document.querySelector('.placeButton');
                const confirmationPopup = document.getElementById('confirmationPopup');
                const confirmButton = document.getElementById('confirmButton');
                const cancelButton = document.getElementById('cancelButton');
                const closeButton = document.querySelector('.close');

                placeOrderButton.addEventListener('click', function (event) {
                    event.preventDefault(); // Prevent default form submission

                    let orderDetails = '';
                    let grandTotal = 0;

                    // Process form and items
                    document.querySelectorAll('.itemChoice').forEach((itemChoice) => {
                        const itemName = itemChoice.querySelector('.itemChoiceHeader').textContent;
                        const quantity = itemChoice.querySelector('select[name="quantities"]').value;
                        const priceText = itemChoice.querySelector('.price').textContent;
                        const price = parseFloat(priceText.replace('$', ''));
                        if (quantity !== '0') {
                            const totalPrice = (price * quantity).toFixed(2); // Calculate total price
                            grandTotal += parseFloat(totalPrice);
                            orderDetails += `<p><strong>${itemName}:</strong> ${quantity} = $${totalPrice}</p>`;
                        }
                    });
                    
                    const firstName = form.querySelector('input[name="firstName"]').value;
                    const lastName = form.querySelector('input[name="lastName"]').value;
                    const phoneNumber = form.querySelector('input[name="phoneNumber"]').value;
                    const email = form.querySelector('input[name="email"]').value;
                    const specialRequests = form.querySelector('input[name="specialRequests"]').value;

                    // Update popup content
                    document.getElementById('popupOrderDetails').innerHTML = orderDetails;
                    document.getElementById('priceTotalAll').innerHTML = '$' + grandTotal;
                    document.getElementById('popupFirstName').textContent = firstName;
                    document.getElementById('popupLastName').textContent = lastName;
                    document.getElementById('popupPhoneNumber').textContent = phoneNumber;
                    document.getElementById('popupEmail').textContent = email;
                    document.getElementById('popupSpecialRequests').textContent = specialRequests;

                    // Update hidden fields
                    const hiddenOrderDetails = document.getElementById('hiddenOrderDetails');
                    const hiddenGrandTotal = document.getElementById('hiddenGrandTotal');
                    if (hiddenOrderDetails && hiddenGrandTotal) {
                        hiddenOrderDetails.value = orderDetails;
                        hiddenGrandTotal.value = grandTotal;
                    }

                    confirmationPopup.style.display = 'block'; // Show the popup if the form is valid
                });

                confirmButton.addEventListener('click', function () {
                    confirmationPopup.style.display = 'none'; // Hide the popup
                    form.submit(); // Submit the form
                    
                });

                cancelButton.addEventListener('click', function () {
                    confirmationPopup.style.display = 'none'; // Hide the popup if canceled
                });

                closeButton.addEventListener('click', function () {
                    confirmationPopup.style.display = 'none'; // Hide the popup when clicking close
                });

                window.addEventListener('click', function (event) {
                    if (event.target === confirmationPopup) {
                        confirmationPopup.style.display = 'none'; // Hide the popup if clicked outside
                    }
                });
            });
        </script>
    </body>
</html>
